(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{203:function(t,e,s){},248:function(t,e,s){"use strict";s(203)},265:function(t,e,s){"use strict";s.r(e);var i={props:["pList","name"],data:()=>({total:1,timer:null,initSpeed:200,speed:null,diff:20,prize:{},time:0,current:-1,isRuningLucky:!1,luckyText:"开始抽奖",list:[],prizeText:"",showAwards:!1}),methods:{selectFrom(t,e){const s=e-t+1;return Math.floor(Math.random()*s+t)},handleStart(t){this.total<1||this.isRuningLucky||isNaN(Number(this.initSpeed))||(this.luckyText="抽奖中",this.speed=this.initSpeed,this.isRuningLucky=!0,this.time=Date.now(),this.getData(t.currentTarget))},getData(t){this.prize={id:this.selectFrom(1,8)},this.move(t)},move(t){const e=this;clearTimeout(this.timer),this.timer=setTimeout(()=>{e.current++,e.current>7&&(e.current=0);for(let e=0;e<t.parentElement.children.length;e++)t.parentElement.children[e].className.indexOf("lottery-act")>-1&&t.parentElement.children[e].classList.remove("lottery-act");if(t.parentElement.children[e.current].classList.add("lottery-act"),e.prize.id&&(Date.now()-e.time)/1e3>2){if(e.speed+=e.diff,(Date.now()-e.time)/1e3>3&&+e.prize.id==+e.list[e.current].id)return clearTimeout(e.timer),void setTimeout(()=>{e.total-=1,e.isRuningLucky=!1,e.luckyText="开始抽奖",e.prizeText=""+e.list[e.current].title,e.$refs.lotteryLayer.style.display="flex"},600)}else e.speed>=50&&(e.speed-=e.diff);e.move(t)},e.speed)},lotteryClose(){this.prizeText="",this.$refs.lotteryLayer.style.display="none"},handleSetList(){this.showAwards=!this.showAwards},handleCloseReset(){this.list=JSON.parse(JSON.stringify(this.pList)),localStorage.removeItem("awards"+this.name),this.showAwards=!1},handleSaveList(){this.list.map((t,e)=>(t.title=t.title.trim(),t)),localStorage.setItem("awards"+this.name,JSON.stringify(this.list)),this.showAwards=!1}},mounted(){const t=JSON.parse(localStorage.getItem("awards"+this.name));this.list=t||JSON.parse(JSON.stringify(this.pList))},destroyed(){clearTimeout(this.timer)}},a=(s(248),s(2)),r=Object(a.a)(i,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"lottery"},[e("div",{staticClass:"lottery-box"},[t._l(t.list,(function(s,i){return e("div",{key:i,class:["lottery-item","lottery-item"+i]},[t._v(t._s(s.title))])})),t._v(" "),e("button",{staticClass:"lottery-btn",style:{background:0==t.total?"#CCC":""},on:{click:function(e){return t.handleStart(e)}}},[t._v(t._s(0==t.total?"没有次数啦":t.luckyText))]),t._v(" "),e("div",{ref:"lotteryLayer",staticClass:"lottery-layer"},[e("img",{attrs:{src:t.$withBase("/img/bingo.png"),alt:"bingo"}}),t._v(" "),e("p",[t._v("\n        恭喜您抽中了\n        "),e("span",[t._v("“ "+t._s(t.prizeText)+" ”")])]),t._v(" "),e("button",{on:{click:t.lotteryClose}})])],2),t._v(" "),e("button",{staticClass:"set-lottery-awards",on:{click:t.handleSetList}},[t._v("设置奖项")]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.showAwards,expression:"showAwards"}],staticClass:"lottery-awards"},[e("div",{staticClass:"lottery-awards-box"},[e("div",{staticClass:"lottery-awards-input"},t._l(t.list,(function(s){return e("input",{directives:[{name:"model",rawName:"v-model",value:s.title,expression:"item.title"}],key:s.id,attrs:{type:"text"},domProps:{value:s.title},on:{input:function(e){e.target.composing||t.$set(s,"title",e.target.value)}}})})),0),t._v(" "),e("div",{staticClass:"lottery-awards-btn"},[e("button",{staticClass:"lottery-awards-close",on:{click:t.handleCloseReset}},[t._v("重置")]),t._v(" "),e("button",{staticClass:"lottery-awards-save",on:{click:t.handleSaveList}},[t._v("保存")])])])])])}),[],!1,null,"b3784d04",null);e.default=r.exports}}]);